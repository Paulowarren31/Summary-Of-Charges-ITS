{% extends 'base.html' %}
{% load humanize %}
{% load money_format %}
{% load staticfiles %}
{% block index %}
<nav class="navbar fixed-top navbar-light bg-faded">
    <div class="row">
        <div class="col-lg-2 col-md-2"><h4>Expense Account</h4></div>
        <div class="col-lg-3 col-md-4"><h4>Item Description & Item Code</h4></div>
        <div class="col-lg-2 col-md-2"><h4>Rate</h4></div>
        <div class="col-lg-2 hidden-md-down"><h4>Average Units</h4></div>
        <div class="col-lg-1 col-md-2"><h4>Billed Units</h4></div>
        <div class="col-lg-2 col-md-2"><h4>Total</h4></div>
    </div>
    <div class="row ">
        <h4><strong>Unit/Group:</strong> {{unit}}</h4>
    </div>
    <div class="row">
        <h4><strong>Date Range</strong> {{dateRange}}</h4>
    </div>
    <div class="row">
        <button class="btn btn-sm m-2" id="ex-all">Expand All</button>
        <button class="btn btn-sm m-2" id="hd-all">Hide All</button>
    </div>


</nav>
<div class="container-fluid" style="width: 80% display: none;">
    <div class="top-row"></div>
    <!-- for each account -->
    {% for account in accounts %}
    <div class="row account">
        <div  class="col-lg-12">
            <strong>I</strong>
            <i id="a-{{forloop.counter}}-row" class="fa fa-minus-circle" aria-hidden="true"></i>

            <strong>{{account.desc}}  ({{account.num}})</strong>
        </div>

        <!--for each group -->
        {% for group in account.items %}

        <div id="a-{{forloop.parentloop.counter}}-{{forloop.counter}}-grp-show" class="col-lg-12">
            {{forloop.counter}}.
            <i id="a-{{forloop.parentloop.counter}}-{{forloop.counter}}-grp" class="fa fa-plus-circle" aria-hidden="true"></i>
            {{group.grp}}
        </div>

        <!-- for each item in group -->
        <div id="a-{{forloop.parentloop.counter}}-g-{{forloop.counter}}-items" class=" col-lg-12 hidden">
            <div class="row">
                {% for item in group.items %}
                <div class="col-lg-4 col-md-5 offset-md-1"> <p>{{item.descr}}<br><strong>{{item.cc|default_if_none:""}}</strong></p></div>
                <div class="col-lg-2 col-md-2">{{item.unit_rate|floatformat:2|money}}</div>
                <div class="col-lg-2 hidden-md-down">{{item.monthly}}</div>
                <div class="col-lg-1 col-md-2">{{item.quantity|default_if_none:""|floatformat:0}}</div>
                <div class="col-lg-2 col-md-2">{{item.total|floatformat:2|money}}</div>
                {% endfor %}
            </div>
        </div>
        <!-- endfor -->

        <!-- group total -->
        <div id="a-{{forloop.parentloop.counter}}-grp"class="col-lg-2 offset-lg-10 col-md-2 offset-md-10 cat-total">{{group.total|floatformat:2|money}}</div>
        {% endfor %}


        <!-- account total -->
        <div class="col-lg-2 offset-lg-10 col-md-2 offset-md-10 account-total">{{account.total|floatformat:2|money}}</div>

    </div>
    {% empty %}
    <div class="row">
        <h4 class="text-danger"> No records found </h4>
        <a class=""href="/">Go Back</a>
    </div>
    {% endfor %}
    <!-- endfor -->
    <div class="row account">
        <div class="col-lg-2 offset-lg-10 col-md-2 offset-md-10 t-total">
            ${{total|floatformat:2|intcomma}}
        </div>
    </div>
</div>

<!-- debug table
    <table class="table table-bordered table-responsive">
    <thead class="thead">
    <tr>
    <th>Expense Account</th>
    <th>Item Description & code</th>
    <th>Rate</th>
    <th>Avg Monthly Units Billed</th>
    <th>Billed Units</th>
    <th>Item Total</th>
    <th>Item Group Total</th>
    <th>Account Total</th>
    </tr>
    </thead>
    <tbody>
    {% for acc in accounts %}
    <tr>
    <td>{{acc.num}} - {{acc.total}}</td>
    </tr>

    {% for cg in acc.items %}
    <tr>
    <td>{{cg.grp}} - {{cg.total}}</td>
    </tr>
    <tr>
    {% for d in cg.items %}
    <td>{{d.descr}}</td>
    <td>{{d.total}}</td>
    <td>{{d.m_count}}</td>
    {% endfor %}
    </tr>
    {% endfor %}
    {% endfor %}
    </tbody>
    </table>
-->

<script src="{% static 'js/table.js' %}"></script>
{% endblock %}
